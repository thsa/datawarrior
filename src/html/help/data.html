<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Analysing Data</title>
  <base href="../">
  <link type="text/css" href="styles.css" rel="stylesheet">
</head>

<body>
<hr align="left" size="2" width="550">
<h2><a name="DataAnalysis"></a>Working with Data</h2>

<hr align="left" size="2" width="550">
<p><span class="keyword">DataWarrior</span> supports you with various means
in the task of exploring and comprehending large datasets, be it with or without chemical structures.
</p>
<br>

<h3><i><a name="Pivoting"></a>Pivoting Data</i></h3>

<p>Consider a data table with three columns, of which the first contains product numbers,
the second column contains a year and the third the profits gained with this item in the given year.
Now imagine you intend to correlate profits between the different years. Then you need the data
table to be arranged differently, i.e. you would need rows to contain products, columns to contain
years and the individual cells to contain the profit values achieved. Column titles would
look like 'Product Number', '2010', '2011', '2012', ... This kind of data transformation technique
is called <i>Pivoting</i> or <i>Cross-Tabulation</i>. This data transformation can be done in
<i>DataWarrior</i> by choosing <span class="menu">New From Pivoting...</span> in the
<span class="menu">File</span> menu, which lets you define involved columns in a dialog and
then creates a new window with the copied and converted data table.</p>

<p align="center"><img src="help/img/analysis/pivot.jpeg"></p>

<p>The example used a file with Dopamine receptor antagonists from the ChEMBL database. Besides
various other information it contained chemical structures, measured effects and receptor subtype
(D1 - D5) in separate columns. Columns were selected to group results in one row per chemical structure
and to split data column into separate columns for every receptor subtype. Three data columns
were selected, the measured numerical <i>value</i>, the <i>unit</i> and the <i>m</i> column,
which sometimes contains a modifier (e.g. '&lt;' symbols).</p>
<br>

<h3><i><a name="ReversePivoting"></a>Reverse Pivoting Data</i></h3>

<p>The <i>Reverse Pivoting</i> transformation is indeed the opposite of the pivoting conversion.
It creates a new <i>DataWarrior</i> document from the original data table. For every original data row
it takes the cell content from multiple selected data columns into one new table column, but multiple
new rows. A second column is created, which receives the column names of the original data columns.
This way every new row is assigned to one of the original selected data columns.
Original cell content of other non-selected columns is redundantly copied to any new row.</p>

<p align="center"><img src="help/img/analysis/depivot.jpeg"></p>

<p>The <i>Reverse Pivoting</i> dialog lets one select those column that shall be merged into one
new column. One also needs to specify a column name for this column as well as for the second new
column, which receives the original column names and serves to assign rows to original categories.</p>
<br>

<h3><i><a name="MergeColumns"></a>Merging Columns</i></h3>
<p>
  This rather simple functionality merges cell content from multiple columns into a new one.
  This may be useful, if multiple columns contain data of the same kind, which shall be used together
  in views, filters or further calculations. After merging into one column, the values from different
  source columns are still separated properly, such that <span class="keyword">DataWarrior</span> still
  perceives them as multiple values. With <span class="menu">Show Multiple Values As...</span>
  from the column title popup menu one may choose to display mean, median, or other display modes.</p>
<p>This rather simple functionality gets interesting when chemical structures are involved, especially
  after an R-group deconvolution (SAR Analysis). In this case chemical structures are not only merged
  into one new structure, they are also rejoined where they contained an R-substituent that is defined in
  one of the columns to be merged. In the following example R2 and R3 are re-joined with the scaffold,
  while R1 is left out and, thus, kept as remaining multiplicity in regard to the new column.</p>
<p align="center"><img src="help/img/analysis/mergeColumns.jpeg" height="288" width="680"></p>
<p><center><i>Merge Column dialog and table view with new column after structure merge.</i></center></p>
<p>If this way a Scaffold is re-united with all but one or two R-group columns, then this allows
  to investigate the influence of these one or two R-groups more closely, when focusing on any
  of the molecule categories that are defined by the merged structure column. This is somewhat
  similar to a molecular matched pair analysis.</p>
<p>Another way to merge multiple chemical structure columns is to specify a transformation reaction,
which considers the molecules to be merged as reactants and defines the chemical transformation
  of how to convert them into a product. If a reaction is specified, then the number and order of
  selected structure columns must match the number and order of the reactants. Moreover, all atoms
  that exist on the reactant and on the product side should be properly mapped, i.e. assigned to each
  other using the editor's mapping tool.</p>
<p align="center"><img src="help/img/analysis/mergeColumnsWithReaction.jpeg" height="309" width="680"></p>
<p><center><i>Merge Column dialog with specified transformation and table view after product formation.</i></center></p>

<br>

<h3><i><a name="Binning"></a>Binning Numerical Data</i></h3>
<p>
If the statistical distribution of all numerical values within one column is of concern,
and if a histograms shall be displayed, then one needs to create a new column from the
numerical values, which assigns a bin to each value, i.e. converts the numerical column
into a special kind of category column.<br>
The <span class="menu">Add Binned Column...</span> from the <span class="menu">Data</span> menu
opens the following dialog, where the bin size and the exact location of the first bin can be
defined, either by moving sliders or by typing in the desired values. A histogram preview shows how
all rows are distributed among the bins with the current settings.</p>
<p align="center"><img src="help/img/analysis/binning.jpeg"></p>
<p><center><i>Binning dialog and histogram view from created new column.</i></center></p>
<br>

<h3><i><a name="JEP"></a>Calculating Column Data From Custom Expressions</i></h3>
<p>
<p>Often there is the need to calculate or extract numerical, date, or text data from other columns,
e.g. to use it for filtering, as graph input values, as merge keys or for other purposes.
For instance, one may extract <i>year</i> and <i>day of the year</i> from complete date values
in order to overlay multiple curves in one graph, of which every one represents a different year's
evolution of some value.</p>
<p>For calculating a new column from existing column values <span class="keyword">DataWarrior</span>
has built in the open source expression parser JEP. It lets you define an arithmetical, logical
or textual expression from constants, operators (+, -, *, >, &, !, ==, etc.), functions as sin(),
sqrt(), if(), contains(), etc. and variables that represent data from other columns.</p>
<p>In addition to the mathematical standard functions, <span class="keyword">DataWarrior</span>
understands various functions related to dates, to molecules, to the data table, or being relevant
in macros. For instance there are functions to calculate molecule similarities, ligand efficiencies,
or the occurance frequency of specific cell values.</p>
<p>To define and process a new expression choose <span class="menu">Add Calculated Values...</span>
from the <span class="menu">Data</span> menu. When typing in a formula you don't need to type variable names.
You rather should select the column name from the selection in the dialog and click
<span class="menu">Add Variable</span>. This ensures correct spelling, especially since some column names
are slightly modified to avoid syntax errors when the expression is parsed.
The expression syntax, all operators and available functions are explained below.</p>
<br>

<p><b>Operators</b></p>
<p>In expressions all common arithmetic and boolean operators are fully supported.
  Boolean expressions are evaluated to be either 1 or 0 (true or false respectively).
  In the following tables a <img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10">
  indicates that the operator can be used with the specific type of variable.</p>

<table align="center" border="0" cellpadding="2" cellspacing="0" width="620">
  <tbody>
  <tr bgcolor="#ccccff">
    <th><font face="sans-serif"><small><b>Description</b></small></font></th>
    <th><font face="sans-serif"><small><b>Function</b></small></font></th>
    <th><font face="sans-serif"><small><b>Double</b></small></font></th>
    <th><font face="sans-serif"><small><b>String</b></small></font></th>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Power</small></font></td>
    <td><font face="sans-serif"><small>^</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Boolean Not</small></font></td>
    <td><font face="sans-serif"><small>!</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Unary Plus, Unary Minus</small></font></td>
    <td><font face="sans-serif"><small>+x, -x</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Modulus</small></font></td>
    <td><font face="sans-serif"><small>%</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Division</small></font></td>
    <td><font face="sans-serif"><small>/</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Multiplication</small></font></td>
    <td><font face="sans-serif"><small>*</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Addition, Subtraction</small></font></td>
    <td><font face="sans-serif"><small>+, -</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"> (only +)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Less or Equal, More or Equal</small></font></td>
    <td bordercolor="#CCCCCC"><font face="sans-serif"><small>&lt;=, &gt;=</small></font></td>
    <td bordercolor="#CCCCCC" align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td bordercolor="#CCCCCC" align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Less Than, Greater Than</small></font></td>
    <td><font face="sans-serif"><small>&lt; ,&gt;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Not Equal, Equal</small></font></td>
    <td><font face="sans-serif"><small>!=, ==</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Boolean And</small></font></td>
    <td><font face="sans-serif"><small>&amp;&amp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Boolean Or</small></font></td>
    <td><font face="sans-serif"><small>||</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  </tbody>
</table>
<br>

<p><b>Mathematical Standard Functions</b></p>
<p>This function set contains more or less all common numerical or string functions, which one would
  expect to find on an electronic calculator, spread sheet or computer language.
  Again the <img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10">
  indicates whether the function can be used with numerical or string parameters.</p>

<table align="center" border="0" cellpadding="2" cellspacing="0" width="620">
  <tbody>
  <tr bgcolor="#ccccff">
    <th><font face="sans-serif"><small><b>Description</b></small></font></th>
    <th><font face="sans-serif"><small><b>Function</b></small></font></th>
    <th><font face="sans-serif"><small><b>Double</b></small></font></th>
    <th><font face="sans-serif"><small><b>String</b></small></font></th>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Sine</small></font></td>
    <td><font face="sans-serif"><small>sin(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Cosine</small></font></td>
    <td><font face="sans-serif"><small>cos(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Tangent</small></font></td>
    <td><font face="sans-serif"><small>tan(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Arc Sine</small></font></td>
    <td><font face="sans-serif"><small>asin(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Arc Cosine</small></font></td>
    <td><font face="sans-serif"><small>acos(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Arc Tangent</small></font></td>
    <td><font face="sans-serif"><small>atan(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Arc Tangent (with 2 parameters)</small></font></td>
    <td><font face="sans-serif"><small>atan2(y, x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Hyperbolic Sine</small></font></td>
    <td><font face="sans-serif"><small>sinh(x)</small></font></td>
    <td bordercolor="#CCCCCC" align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td bordercolor="#CCCCCC" align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Hyperbolic Cosine</small></font></td>
    <td><font face="sans-serif"><small>cosh(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Hyperbolic Tangent</small></font></td>
    <td><font face="sans-serif"><small>tanh(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Inverse Hyperbolic Sine</small></font></td>
    <td><font face="sans-serif"><small>asinh(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Inverse Hyperbolic Cosine</small></font></td>
    <td><font face="sans-serif"><small>acosh(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Inverse Hyperbolic Tangent</small></font></td>
    <td><font face="sans-serif"><small>atanh(x)</small></font></td>
    <td bordercolor="#CCCCCC" align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Natural Logarithm</small></font></td>
    <td><font face="sans-serif"><small>ln(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Logarithm base 10</small></font></td>
    <td><font face="sans-serif"><small>log(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Exponential</small></font></td>
    <td><font face="sans-serif"><small>exp(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Absolute Value / Magnitude</small></font></td>
    <td><font face="sans-serif"><small>abs(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Integer Value</small></font></td>
    <td><font face="sans-serif"><small>int(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Rounded Value</small></font></td>
    <td><font face="sans-serif"><small>round(x, scale)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Random number (between 0 and 1)</small></font></td>
    <td><font face="sans-serif"><small>rand()</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Modulus</small></font></td>
    <td><font face="sans-serif"><small>mod(x, y) = x % y</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Square Root</small></font></td>
    <td><font face="sans-serif"><small>sqrt(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Sum (of three values)</small></font></td>
    <td><font face="sans-serif"><small>sum(x, y, z)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Maximum (returns larger value)</small></font></td>
    <td><font face="sans-serif"><small>max(x,y)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Minimum (returns smaller value)</small></font></td>
    <td><font face="sans-serif"><small>min(x,y)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>If (returns x if condition is true, y if false)</small></font></td>
    <td><font face="sans-serif"><small>if(condition, x, y)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Is Empty (String or Number; returns 1 or 0)</small></font></td>
    <td><font face="sans-serif"><small>isempty(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Replace Empty (returns y if x is empty, otherwise returns x)</small></font></td>
    <td><font face="sans-serif"><small>replaceempty(x, y)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>String of</small></font></td>
    <td><font face="sans-serif"><small>str(x)</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>String length</small></font></td>
    <td><font face="sans-serif"><small>len(s)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Checks whether string s1 contains s2 (1 or 0)</small></font></td>
    <td><font face="sans-serif"><small>contains(s1, s2)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>n-th position of String s2 in String s1</small></font></td>
    <td><font face="sans-serif"><small>indexof(s1, s2, n)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Substring of string s from m-th char to (n-1)th char</small></font></td>
    <td><font face="sans-serif"><small>substring(s, m, n)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>n-th entry, when splitting s1 at all occurences of s2</small></font></td>
    <td><font face="sans-serif"><small>entry(s1, s2, n)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>String s after replacing all occurrences of regex f with r</small></font></td>
    <td><font face="sans-serif"><small>replace(s, f, r)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Check if s matches the regular expression r</small></font></td>
    <td><font face="sans-serif"><small>matchregex(s, r)</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
    <td align="center"><font face="sans-serif"><small><img src="help/jepcheckmark.png" alt="Check" border="0" height="10" width="10"></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Binomial coefficients</small></font></td>
    <td><font face="sans-serif"><small>binom(n, i)</small></font></td>
    <td align="center"><font face="sans-serif"><small>integers</small></font></td>
    <td align="center"><font face="sans-serif"><small>&nbsp;</small></font></td>
  </tr>
  </tbody>
</table>
<br>

<p><b>Date Functions</b></p>
<p>If a column contains date values, then <i>DataWarrior</i> recognizes them automatically.
  Internally, date values are represented as the number of days that have been passed since Jan 1st, 1970.
  Therefore, when a date column is used in filters or assigned to an axis, the behaviour is nicely proportional
  and covers the full date range in a linear way. When used in expressions the following date functions
  work seemlessly with date values from date columns.</p>

<table align="center" border="0" cellpadding="2" cellspacing="0" width="620">
  <tbody>
  <tr bgcolor="#ccccff">
    <td><font face="sans-serif"><small><b>Description</b></small></font></td>
    <td><font face="sans-serif"><small><b>Function</b></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Day of Week (1 := Monday)</small></font></td>
    <td><font face="sans-serif"><small>dayOfWeekEU(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Day of Week (1 := Sunday)</small></font></td>
    <td><font face="sans-serif"><small>dayOfWeekUS(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Day of Week (1 := Saturday)</small></font></td>
    <td><font face="sans-serif"><small>dayOfWeekME(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Day of Month from Date</small></font></td>
    <td><font face="sans-serif"><small>dayOfMonth(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Day of Year from Date</small></font></td>
    <td><font face="sans-serif"><small>dayOfYear(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Week of Year (ISO 8601, week starts on Monday; Jan,4 is week 1)</small></font></td>
    <td><font face="sans-serif"><small>weekISO(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Week of Year (week starts with Monday; Jan,1 is week 1)</small></font></td>
    <td><font face="sans-serif"><small>weekEU(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Week of Year (week starts with Sunday; Jan,1 is week 1)</small></font></td>
    <td><font face="sans-serif"><small>weekUS(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Week of Year (week starts with Saturday; Jan,1 is week 1)</small></font></td>
    <td><font face="sans-serif"><small>weekME(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Month from Date</small></font></td>
    <td><font face="sans-serif"><small>month(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Year from Date</small></font></td>
    <td><font face="sans-serif"><small>year(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Year from Date (corresponding to weekISO)</small></font></td>
    <td><font face="sans-serif"><small>yearISO(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Year from Date (corresponding to weekEU)</small></font></td>
    <td><font face="sans-serif"><small>yearEU(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Year from Date (corresponding to weekUS)</small></font></td>
    <td><font face="sans-serif"><small>yearUS(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Year from Date (corresponding to weekME)</small></font></td>
    <td><font face="sans-serif"><small>yearME(date-value)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Date of today</small></font></td>
    <td><font face="sans-serif"><small>today()</small></font></td>
  </tr>
  </tbody>
</table>

<p>Date functions allow to extract the day, month or year from a date value. If a column
  was recognized by DataWarrior to contain date values, then one can use these functions to get
  a numerical value that reflects the day, month or year.</p>
<p>The <b>dayOfWeekEU()</b> function returns values from 1 to 7 representing Monday to Sunday
  according to ISO-8601, which defines Monday as the first day of the week. While this is
  mainly used in Europe and Asia, other regions of the world consider Saturday or Sunday the first day
  of the week and may use <b>dayOfWeekUS()</b> or <b>dayOfWeekME()</b>, respectively.</p>
<p>The <b>dayOfMonth()</b> and <b>dayOfYear()</b> functions also return values starting with 1,
  which always indicates the first day of the period. Analogously, the <b>month()</b> function
  returns values from 1 to 12 representing January to December, respectively.
  The <b>year()</b> function extracts the year as a 4-digit number.</p>
<p>The <b>weekISO()</b>, <b>weekEU()</b>, <b>weekUS()</b>, and <b>weekME()</b> functions return
  the calendar week according to regional conventions. These define which day is considered the
  first day of the week and which date defines week 1.</p>
<p>The <b>yearISO()</b>, <b>yearEU()</b>, <b>yearUS()</b>, and <b>yearME()</b> functions return
  a year that matches the respective weekXXX() functions. Here the new year starts with the first day
  that is considered to belong to week 1. This day may still be in December or it may be one of the
  first days of January.</p>
<p>The <b>today()</b> function returns the current date as the number of days that have been passed
  since Jan 1st, 1970. Because <i>DataWarrior</i> represents date values the same way, the today()
  function can be used to convert an absolute date into the number of days that
  have been passed since then. For this use an expression like <i>today()-myDataColumn</i>.</p>
<br>

<p><b>Table Related Functions</b></p>
<p>When DataWarrior calculates new column values applying a given custom formula,
  then it solves the expression for every row individually.
  During any of these calculations variables represent data from the currently processed row only.
  Data from other rows is not visible to the expression evaluator and cannot be used in the formula.
  For certain purposes, however, the data from other rows must be taken into account. For instance,
  if a value must be normalized and centered relative to all values of the same column, then these
  must be known. Some functions need to know about values of other rows, which belong to a shared
  category. Or sometimes access of the previous row needed in order to calculate a value increase.
  The following functions have in common that they all preprocess the entire table before starting
  to calculate values for every row. This way all background information is available under the hood,
  when the particular row's expression is evaluated.</p>
<p><b>Note:</b> Some of these function results depend on the table sort order,
  e.g. the value increase from the previous row obviously must
  depend on which row is located above the row for which the increase is calculated.</p>
<p><b>Note:</b> Many of these functions require a column name as parameter,
  which is not the variable holding the row's value. It is the exact column name as it appears in
  the table header put into double quotes.</p>

<table align="center" border="0" cellpadding="2" cellspacing="0" width="620">
  <tbody>
  <tr bgcolor="#ccccff">
    <td><font face="sans-serif"><small><b>Description</b></small></font></td>
    <td><font face="sans-serif"><small><b>Function</b></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Row index of processed row</small></font></td>
    <td><font face="sans-serif"><small>row()</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Numerical summary value of cell</small></font></td>
    <td><font face="sans-serif"><small>numvalue(column-name, row)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Numerical individual value of cell</small></font></td>
    <td><font face="sans-serif"><small>numcellvalue(column-name, n, sortMode)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Number of cell values including empty ones</small></font></td>
    <td><font face="sans-serif"><small>valueCount(column-var)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Number of non empty cell values</small></font></td>
    <td><font face="sans-serif"><small>nonEmptyValueCount(column-var)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Standard deviation of cell values from mean</small></font></td>
    <td><font face="sans-serif"><small>valueStdDev(column-var)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Frequency of occurance</small></font></td>
    <td><font face="sans-serif"><small>frequency(value, column-name)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Frequency of same value in same category</small></font></td>
    <td><font face="sans-serif"><small>frequencyInCategory(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Previous value in category</small></font></td>
    <td><font face="sans-serif"><small>previousInCategory(category-column, value-column, n)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Absolute value increase from previous row</small></font></td>
    <td><font face="sans-serif"><small>increase(value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Absolute value increase in category</small></font></td>
    <td><font face="sans-serif"><small>increaseInCategory(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Percent increase from previous row</small></font></td>
    <td><font face="sans-serif"><small>percentIncrease(value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Percent increase in category</small></font></td>
    <td><font face="sans-serif"><small>percentIncreaseInCategory(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Cumulative sum of previous rows</small></font></td>
    <td><font face="sans-serif"><small>cumulativeSum(value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Cumulative sum in category</small></font></td>
    <td><font face="sans-serif"><small>cumulativeSumInCategory(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Moving sum in category</small></font></td>
    <td><font face="sans-serif"><small>movingSumInCategory(category-column, value-column, n1, n2)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Moving average in category</small></font></td>
    <td><font face="sans-serif"><small>movingAverageInCategory(category-column, value-column, n1, n2)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>First value within category</small></font></td>
    <td><font face="sans-serif"><small>categoryFirst(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Last value within category</small></font></td>
    <td><font face="sans-serif"><small>categoryLast(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Smallest value in category</small></font></td>
    <td><font face="sans-serif"><small>categoryMin(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Largest value in category</small></font></td>
    <td><font face="sans-serif"><small>categoryMax(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Sum of values in category</small></font></td>
    <td><font face="sans-serif"><small>categorySum(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Mean value in category</small></font></td>
    <td><font face="sans-serif"><small>categoryMean(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Median value in category</small></font></td>
    <td><font face="sans-serif"><small>categoryMedian(category-column, value-column)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Reference value in category</small></font></td>
    <td><font face="sans-serif"><small>refvalue(ref-ID-column, category-column, value-column, ref-ID)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Normalize and center value</small></font></td>
    <td><font face="sans-serif"><small>normalize(value, column-name)</small></font></td>
  </tr>
  </tbody>
</table>

<p>The <b>row()</b> function just returns the row index of the currently processed row starting with 1
  for the first row of the table.</p>
<p>The <b>numvalue()</b> function returns the numerical content of a cell defined by its column name and
  its row index starting from 1 for the first row in the table. If a cell contains multiple values, then
  this function retrieves the summary value of the current summary mode (mean, median, min, ...).</p>
<p>The <b>numcellvalue()</b> function returns the numerical value of the n-th values of a cell's content.
  The cell is defined by its column name and the currently processed row. If sortMode is not 0, then
  the cell entries are sorted before taking the n-th value (1:ascending; 2:descending).
  Modifiers as '<' are neglected. Columns in logarithmic mode return the logarithms of the original value.
  When sorting, then empty and NaN values are considered larger than the highest numbers.</p>
<p>The <b>valueCount()</b> function counts the number of entries in a particular cell, no matter
  whether these are separated by '; ' or whether they are in separate lines. Empty values are included.
  The function takes any variable name that refers to a displayable table column.</p>
<p>The <b>nonEmptyValueCount()</b> function works like valueCount(), but does not include empty values.</p>
<p>The <b>valueStdDev()</b> function calculates the standard deviation of all value within one cell in regard
  to their mean value.</p>
<p>The <b>frequency()</b> function counts how many rows of the entire table contain the given value
  in the specified value-column. When using this function, then typically, but not necessarily, <i>value</i>
  is a column variable, while <i>value-column</i> is the name of the same column, e.g. 'frequency(AnimalKind,
  "Animal Kind")'.</p>
<p>The <b>frequencyInCategory()</b> function is similar to the <b>frequency()</b> function, but in addition
  it considers the row's category membership. It counts, how many table rows contain the given value in the
  value-column and belong at the same time to the specified category, i.e. have the given category value in
  the category-column.</p>
<p>The <b>previousInCategory()</b> function locates the n-th row above the currently processed row, while only
  considering rows that belong to the same category. Then it returns the specified column's value of that row.
  The function returns NaN, if less than n rows exist above the currently processed row.</p>
<p>The <b>increase()</b> and <b>percentIncrease()</b> functions calculate the value increase from the previous row,
  as absolute difference or as percentage relative to the previous value. The <b>cumulativeSum()</b> function
  calculates the total sum of this value and all previous values. All three functions depend on the table sort
  order.</p>
<p>The <b>increaseInCategory(), percentIncreaseInCategory(), cumulativeSumInCategory(), movingSumInCategory()</b>, and
  <b>movingAverageInCategory()</b> functions all calculate a value from multiple rows, which belong to the same
  specified category. They all depend on the table's current sort order. <b>increaseInCategory()</b>
  calculates the absolute increase of the current row's value in regard to the value of the closest row
  in the table above, which belongs to the same category.
  <b>percentIncreaseInCategory()</b> gives you the relative increase in percent. <b>cumulativeSumInCategory()</b>
  calculates the sum of all previous values plus the current row's value within the same category.</p>
<p><b>movingAverageInCategory()</b> calculates an average from the row's value, <i>n1</i> previous and
  and <i>n2</i> following values in the table that belong to the same category. If the table contains less
  than n1 previous rows or less than n2 following rows matching the same category, then an average value in
  calculated anyway from the available rows only.</p>
<p>Similarly, the <b>movingSumInCategory()</b> calculates the value sum from the row's value, the <i>n1</i> previous
  and the <i>n2</i> following values that belong to the same category. If the table contains less than n1 previous rows
  or less than n2 following rows matching the same category, then NaN is returned.</p>
<p>The <b>categoryFirst()</b> and <b>categoryLast()</b> functions return the first (or last) row's value from the given
  value-column and those rows, which belong to the specified category. Thus, the result depends on the current order
  of table rows.
  <br>Example: If a table contains stock prices from different companies and different dates, then in order to
  visualize the relative price evolution of the different companies over time, one might sort the table by ascending
  date and then calculate a new column 'Relative price' using the formula 100*price/categoryFirst("Company","Price").
  A scatter plot showing relative prices over the date with lines connecting companies would nicely show the price
  evolution curves of all companies starting all at 100%.<p>
<p>All other <b>categoryXxxx()</b> functions work similar as <b>categoryFirst()</b>, but these are independent of
  the table row order. These functions all summarize different aspects of all numerical values in a given column,
  whose rows belong to the same category, defined by another column. Depending on the specific function,
  the lowest or highest value, the mean or median or even the sum of all individual values within that category are
  returned. Empty cells are not considered. If single cells contain multiple values, then these are first summarized
  using the defined <i>multiple value mode</i>. Thus, every cell contributes one (potentially summary) value to the
  summarized category value.</p>
<p>The <b>refvalue()</b> function is a look-up function that finds within all rows of
  a given category that particular row, which contain a given ID in a given ID-column.
  The identified row is then considered the reference row for the entire category and contains supposedly a reference value
  in a specified column. For all rows of the same category the refvalue() function returns the same value.<br>
  The following example shall make it more clear. Let's assume that we have measured a set of compounds in multiple experiments.
  For every compound we have a result value for every experiment and the corresponding dataset contains these three columns:<br>
  'Experiment-ID': an experiment identifier that serves as a category name<br>
  'Compound-ID': the compound identifier (ID-Column)<br>
  'Result': contains a measured numerical experimental result value
  Let's further assume that one compound named 'A-123' shall serve as a reference compound within all experiments.
  We intend using its measured value to normalize all other result values within the same experiment. In this case we
  we would use the function <i>refvalue("Compound-ID","Experiment-ID","Result","A-123")</i> to get the result of the
  reference compound within the same experiment. Note that all function parameters are hard-coded text strings, three
  column names and one compound identifier.</p>
<p>The <b>normalize()</b> function normalizes and centers an input value based on the distribution
  statistics of one column's numerical values. Typically, the input value itself is from the same column,
  but this doesn't need to be. The normalization is achieved by subtracting the column's mean from the
  input value and then dividing by the square root of the column's variance. Value normalization is needed
  if multiple columns shall be used as input for an unbiased machine learning approach.</p>
<br>

<p><b>Biology and Chemistry Related Functions</b></p>
<p>In addition to the functions above, DataWarrior provides a few special functions that may be useful
  in the context of drug discovery and chem- or bio-informatics. Different to the functions above,
  these functions may also use chemical structures, reactions or descriptors as parameters.</p>

<table align="center" border="0" cellpadding="2" cellspacing="0" width="620">
  <tbody>
  <tr bgcolor="#ccccff">
    <td><font face="sans-serif"><small><b>Description</b></small></font></td>
    <td><font face="sans-serif"><small><b>Function</b></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Ligand Efficiency (HTS)</small></font></td>
    <td><font face="sans-serif"><small>ligeff1(ra, conc in <b>&#956;mol/l</b>, structure)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Ligand Efficiency (IC50)</small></font></td>
    <td><font face="sans-serif"><small>ligeff2(ic50 in <b>nmol/l</b>, structure)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Chemical Similarity (A)</small></font></td>
    <td><font face="sans-serif"><small>chemsim(descriptor, idcode)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Chemical Similarity (B)</small></font></td>
    <td><font face="sans-serif"><small>chemsim(descriptor1, descriptor2)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Highest Chemical Similarity</small></font></td>
    <td><font face="sans-serif"><small>maxsim(descriptor)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Substructure Count (A)</small></font></td>
    <td><font face="sans-serif"><small>chemsss(structure, idcode, mode)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Substructure Count (B)</small></font></td>
    <td><font face="sans-serif"><small>chemsss(structure, substructure, mode)</small></font></td>
  </tr>
  </tbody>
</table>

<p>The <b>ligeff1()</b> and <b>ligeff2()</b> functions calculate
  ligand efficiencies as relative free binding energy in <b>kcal/mol per non-H atom</b>. While the first
  function <b>ligeff1()</b> requires the remaining activity of an HTS result, the second syntax
  <b>ligeff2()</b> needs IC50 values to work on. Ligand efficiency values are a much more reasonable
  basis for selecting leads of an HTS campaign than remaining activities, because this avoids the strong
  bias towards high molecular weight compounds, which is an implicit drawback of selecting those compounds
  as leads, which have a remaining activity below a certain threshold. Also during lead optimization one
  should compare target affinities based on ligand efficiencies rather than pure IC50 values.
  <br><i>"For the purposes of HTS follow-up, we recommend considering optimizing the hits or leads with
    the highest ligand efficiencies rather than the most potent..."</i> (Ref.: A. L. Hopkins et al., <i>Drug
    Disc. Today</i>, <b>9</b> (2004), pp. 430-431).
  <br><br>To give an example: A compound with 30 atoms (400 MW) that binds with a <i>K</i><sub>d</sub>=10 nM
  has a ligand efficiency value of 0.36 kcal/mol per non-H atom. Another compound with 38 non-H atoms (500 MW)
  and the same ligand efficiency would have a 100 fold higher activity with <i>K</i><sub>d</sub>=0.106 nM.
  Let us assume an HTS screening revealed two hit compounds A and B with equal activities of IC<sub>50</sub>=10
  nm, but different molecular weights of 400 and 500, respectively. Based on activities both compounds look
  equally attractive. Considering, however, that a synthetic introduction of a new group with 8 non-H
  atoms into compound A would match compound B in terms of weight, but would increase the activity by a factor
  of 100, if its ligand efficiency value can be maintained, it becomes clear that compound A is the by far
  more attractive alternative.
  <br><br>The remaining activity <i>ra</i> supplied to the <b>ligeff1()</b> function should be roughly between
  0 and 100. The second parameter to this function is the assay concentration <i>conc</i> of the potential
  inhibitor in &#956;mol/l. The third parameter is the molecular <i>structure</i> from which the number of
  non-hydrogen-atoms is determined automatically. In order to avoid misinterpretations one should
  understand the way the <b>ligeff1()</b> function works:
  <br><b>1) </b><i>ra</i> values below 1.0 are set
  to 1.0. Those above 99.0 are set to 99.0.
  <br><b>2) </b>IC50 values are calculated from these range limited
  <i>ra</i> values as ic50 = conc / (100/ra - 1.0)
  <br><b>3) </b>Assuming that the ic50 values are equivalent to the Kd
  the free energy of the ligand binding is calculated as dG = -RT * ln(ic50) with R=1.986 cal/(mol*K)
  and T=300K
  <br><b>4) </b>The ligand efficiency is then calculated as ligeff = dG/N<sub>non-hydrogenatoms</sub>.
  <br>The consequences from the calculation are: Calculated ic50 values cover 4 log units with those values
  at the lower and upper end of this range having the highest uncertainty, i.e. the higher the noise
  of the screening the higher is the uncertainty of ic50 values and also of ligand efficiency values,
  especially those at the lower and higher end of the scale.<br>
  If one can use the second function <b>ligeff2()</b> based on measured IC50 values, one avoids the error
  potential of the calculation of IC50 values from remaining activities. Ligand efficiency values from this
  function are therefore much more reliable and only contain the error margin of the original IC50 value.</p>
<p>The <b>chemsim()</b> function calculates similarities
  between two chemical structures or reactions. This function is available in two variations:
  <br><br><b>A </b>Use syntax A to calculate the similarities of one column's chemistry objects against
  one reference compound or reaction. The first parameter of this function defines the kind of similarity
  to be calculated. It must be the name of a descriptor column from the popup menu. The second
  parameter is the idcode of the reference structure. The following example calculates the
  3D-pharmacophore similarity of the compounds in column <i>Structure</i> to pyridin (gFx@@eJf`@@@ is
  the idcode of pyridin).<br><br>Example: chemsim(PP3DMM2_of_Structure,"gFx@@eJf`@@@")<br><br>
  <b>B </b>Alternatively, you may use syntax B to calculate the similarities between two diffent columns
  containing chemistry objects. In this case you may need to calculate chemical descriptors first. Be
  aware that the descriptors supplied to the chemsim() function need to be of the same type. This example
  calculates the similarities between a <i>Reactant</i> and a <i>Product</i> column.
  <br><br>Example: chemsim(FragFp_of_Reactant,FragFp_of_Product)</p>
<p>The <b>maxsim()</b> function calculates the chemical similarity to all other compounds
  and returns the highest of these similarity values. In other words it calculates the similarity
  to the most similar other compound in the data set. The function's only parameter is chemical descriptor,
  which determines the kind of similarity to be used. One application for this function would be in the field
  of machine-learning. When structure derived descriptors serve as input data for a machine-learning approach,
  then it is crucial that the compounds used for model testing are substantially different in structure from
  any compound used in the model training phase. A reasonable cut-off value depends on the particular problem
  and on the descriptor used. As a rule of thumb values below 0.6 (SkelSpheres), 0.55 (SphereFp), 0.45 (PathFp),
  0.4 (FragFp), and 0.2 (Flexophore) ensure that all other molecules in the data set are pretty dissimilar in
  the eyes of the descriptor. Example: maxsim(SkelSpheres_of_Structure)</p>
<p>The <b>chemsss()</b> function runs a substructure search of the second argument in the first one
  and returns the number distinct substructure matches. The <i>mode</i> parameter defines whether multiple
  distinct matches are counted and what is considered a distinct match:
<li>0: Matches are not counted. If a match is found, 1 is returned, otherwise 0 is returned.</li>
<li>1: Matches don't share any atoms, which means that any two matches must not overlap.
  Note that match counting with mode=1 is not deterministic and depends on atom orders.</li>
<li>2: Matches may partially overlap; any two matches may share some atoms, but not all atoms.</li>
<li>3: Any match is counted including symmetrically flipped and rotated permutations, which match on
  the same atoms just with a different order.</li>
  <br>This function is available in two variations:
  <br><br><b>A </b>Use syntax A to determine the substructure count of one predefined substructure
  for all structures within a given structure columns. The first parameter of this function is the variable
  holding the current row's structure. The second parameter must be an idcode of the substructure.
  To determine the number of distinct, but potentially overlapping pyridin rings within all the structures
  of the column 'Structure' one would use the following syntax (gFx@@eJf`@@@ is
  the idcode of pyridin).<br><br>Example: chemsss(Structure,"gFx@@eJf`@@@", 2)<br><br>
  <b>B </b>Alternatively, if your table contains multiple structure columns, then you may use syntax B
  to count substructure matches of one column's (sub)substructure within the structure of another column.
  <br><br>Example: chemsss(Structure, Fragment, 2)</p>
<br>

<p><b>Macro related Functions</b></p>
<p>These functions are typically used in expressions that are evaluated as part of a macro.</p>

<table align="center" border="0" cellpadding="2" cellspacing="0" width="620">
  <tbody>
  <tr bgcolor="#ccccff">
    <td><font face="sans-serif"><small><b>Description</b></small></font></td>
    <td><font face="sans-serif"><small><b>Function</b></small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Ask for string value</small></font></td>
    <td><font face="sans-serif"><small>askString(dialog-message)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Ask for a numerical value</small></font></td>
    <td><font face="sans-serif"><small>askNumber(dialog-message)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Ask for a column variable</small></font></td>
    <td><font face="sans-serif"><small>askColumnVar(dialog-message)</small></font></td>
  </tr>
  <tr bgcolor="#ffffff">
    <td><font face="sans-serif"><small>Ask for a column title</small></font></td>
    <td><font face="sans-serif"><small>askColumnTitle(dialog-message)</small></font></td>
  </tr>
  </tbody>
</table>
<br>
<p>The <b>askColumnVar(), askColumnTitle(), askString()</b> and <b>askNumber()</b>
  functions are special functions, which do not calculate anything. Instead they interactively ask the user to provide some
  information before any calculation is done. The argument <i>dialog-message</i> is shown within a dialog to the user.
  Typically it will be something like <i>'Which column do you want to base your calculation on?'</i>.<br>
  The <b>askColumnVar()</b> function lets the user select a column from the current dataset and returns
  the name of the variable, which refers to the column content.<br>
  The <b>askColumnTitle()</b> function also asks the user to select a column. However, it returns the column-name
  as a String value.<br>
  The <b>askString()</b> function asks for a text string to be entered, which is then returned as double-quoted String value.<br>
  The <b>askNumber()</b> function asks for a numerical value, which can be used in the formula, wherever a numerical
  value is appropriate.<br>
  These functions help automating DataWarrior with task sequences, since they allow to specify task conditions
  at run-time rather than at task definition time.</p>
<br>

<h3><a name="Gini"></a>The Gini Selectivity Score</h3>

<p>The <span class="keyword">Gini Coefficient</span> was originally invented to represent the income or wealth
distribution of a nation's residents, and is today the most commonly used measure of inequality.
For instance, in the context of medicinal chemistry P. Graczyk applied it to express the selectivity of
kinase inhibitors (doi:10.1021/jm070562u). A <span class="keyword">Gini Coefficient</span> of 0.0 expresses
perfect equality, where all values are the same, while a value of 1.0 represents maximal inequality, e.g. a
totally selective inhibitor that is only active on one of many kinases.
Typically, the <span class="keyword">Gini Coefficient</span>
is used for a large number of positive numerical values of which a few are much larger than the rest.
Thus, inhibition values are a perfect input, while logarithmic data is a less meaningful data source.</p>
<p>To calculate the <span class="keyword">Gini Coefficient</span> in <span class="keyword">DataWarrior</span>
one needs to provide the input values in columns. The <span class="menu">Calculate Selectivity Score...</span>
item in the <span class="menu">Data</span> menu opens a dialog that lets you define a set of columns by
either selecting them indiviually from a list or by specifying a common element of the columns' names.
In addition one may select an option that converts effect values to inhibition values by subtracting the
original value from 100. <span class="keyword">DataWarrior</span> then calculates a new column containing the
<span class="keyword">Gini Coefficient</span> using the trapez method as described in the paper by Graczyk.
However, <span class="keyword">DataWarrior</span> does not change input values to limit the value range
to 0 to 100, because this would reduce the noise in an unsymmetrical fashion. We consider the
<span class="keyword">Gini Coefficient</span> robust enough to digest negative input data without
sacrificing its usefulness.</p>
<br>

<h3><a name="Fuzzy"></a>Defining a Fuzzy Score</h3>

<p>Sometimes it is helpful to express the fitness or usefulness of an object with a single numerical value,
which somehow summarizes the fitness of multiple properties. For this purpose
<span class="keyword">DataWarrior</span> allows to calculate a <span class="keyword">fuzzy score</span>
from multiple contributing property values. These values may be taken from numerical columns of the data set
or they may be calculated on-the-fly from a chemical structure. No matter, which individual properties
are used, <span class="keyword">DataWarrior</span> derives from every contributing property an individual
score between 0.0 and 1.0. This is done using a smooth sigmoid curve defined for every property.
In the dialog (see below) this curve is drawn in magenta color. The curve's slope and inflection point(s)
can be adjusted by setting the <span class="menu">Minimum</span> and <span class="menu">Maximum</span>
values as well as by moving the <span class="menu">Slope</span> slider.
An additional <span class="menu">Weight</span> slider allows to reduce or increase the contribution of
the associated property's score to the overall score.</p>
<p>The individual valuation scores are then summarized by calculating their mean value or by multiplying all
individual scores (geometrical mean). Usually the latter method is chosen, if an object can be considered
useless, if one bad property alone can ruin it.</p>
<p>The properties that contribute to the overall fuzzy score are compiled by adding property specific
panels to the lower scrollable part of the dialog. This is done by selecting the property's name in the
<span class="menu">Contributing Values</span> popup menu and pressing the <span class="menu">Add Value</span>
button. Then a new panel appears at the end of the property panel list letting you define the valuation curve.
If the property refers to the current data set, then the distribution of the associated column's data is
shown as a histogram in the curve area. This helps defining proper valuation curves.</p>
<p>Defining a fuzzy score profile is often done once and then applied multiple times on the same, but updated
data set or on different data sets. Therefore, this functionality is often used within a macro.</p>
<p align="center"><img src="help/img/analysis/fuzzy.jpeg"></p>
<p><center><i>Fuzzy score dialog defined to reward low IC50 values and low molecular weights.</i></center></p>
<p></p>
<br>

<h3><a name="Graph"></a>Working with Graph Data</h3>

<p>Often the rows of a data table represent objects that are logically connected or related,
e.g. if some objects are similar to others or if objects are parent to or predecessors of others.
<span class="keyword">DataWarrior</span> uses a simple way to define these kinds of relationships between
rows, provided that one column contains names or numbers, which uniquely identify every row.
If then a second column's cells contain one or more of these identifiers, then these rows effectively
point to (or reference) other rows of the same table. This turns the table of rows into a graph whose nodes
are represented by table rows and whose edges are defined by row references.
If you want <span class="keyword">DataWarrior</span>
to understand and make use of row links you need to tell <span class="keyword">DataWarrior</span> which
column references which identifier column. Choose <span class="menu">Set Column Reference...</span> from the popup
menu that appears upon a right mouse click within the referencing column's title area.</p>

<p align="center"><img src="help/img/analysis/setColumnRef.png" width=640 height=172></p>
<p><center><i>Popup menu and dialog to define a column reference.</i></center></p>

<p><b>Column Name:</b> This is the column that references the identifier column. Typically, it contains zero,
one, or multiple identifiers in every cell, which establish the link or reference to other rows.
If the dialog was opened through a column popup menu as shown above, then this column was implicitly chosen
in that step and cannot be changed in the dialog.</p>

<p><b>Referenced column:</b> This popup menu defines the column containing unique row identifying names or numbers.
It does not contain columns with duplicate entries.</p>

<p><b>Strength column:</b> This popup menu allows to assign a numerical column, whose values define the strength
of the link. If choosing a strength column it must have the same number of values in every row as the referencing column,
i.e. every referencing identifier must have a matching strength value.</p>

<p><b>Links are bi-directional:</b> If links are defined in the referencing column by one entry only,
then we have a directed graph, which may define one or more trees, cycles or just linear strings of connected
rows. Typical examples are parent or child relationships. Alternatively, relationships may not have a direction.
In this case every link is defined by two identifier entries: each of the two linked rows points to its opposite row.
This kind of link is typical to represent neighbourship or high row similarities.</p>

<p>Once a column reference is defined and therefore rows are crosslinked with each other, what can you do with it?
<ul>
<li>Most obvious is that these links can be shown as connection lines in scatter plots. For that to happen choose
<span class="menu">Set Column Reference...</span> after a right mouse click within the particular 2D- or 3D-view.
In the connection line dialog choose your referencing column from the <span class="menu">Group & connect by</span>
menu. You may also adjust the line width or invert the arrow direction in case of directed links. Note that the
position of your row markers is not touched when showing direction lines. These still depend on which columns
are assigned to the two or three axes.</li>
<li>You may configure a view to show a sub-graph starting from the currently selected reference row as root.
Since reference rows can be changed with one mouse click, such a view is a very dynamic one and shows a
different sub-graph with every change of the reference row. These sub-graphs are trees whose nodes are automatically
arranged to optimize the tree layout. You may choose between a circular tree layout with the root in its center or a
traditional hierarchical tree with the root node at one of the view edges. To show dynamic sub-graphs choose
anything but <span class="menu">none</span> from the <span class="menu">Detail tree mode</span> options in
the connection line dialog.</li>
<li>You may ask <span class="keyword">DataWarrior</span> to calculate an optimized set of 2D-coordinates
for your rows, which are optimized to visualize your row relations. The used algorithm tries to optimize
two criteria: Linked rows are placed close to each other and all rows are distributed evenly over the
available space. The following section explains this in more detail.</li>
</ul>
</p>
<br>

<h3><a name="ArrangeGraph"></a>Arranging Rows According to Graph Relationships</h3>

<p>If one column is defined to reference another one and, therefore, rows are linked to other rows then
<span class="keyword">DataWarrior</span> may use this information to arrange all rows on a 2-dimensional
plane such that the distance of linked rows is minimized. For that <span class="keyword">DataWarrior</span>
uses a <span class="keyword">Rubberband Scaling</span> algorithm that generates new X and Y coordinates
for each row. When these coordinates are assigned to the two axes of a 2D-view, then even complex graphs can be
displayed nicely. <span class="keyword">DataWarrior</span> uses the same algorithm to visualize chemical
space after a <a href="help/chemistry.html#SimAnalysis">similarity</a> or <a href="help/chemistry.html#SimAnalysis">
activity cliff</a> analysis.</p>

<p>To calculate row coordinates using this method choose <span class="menu">Arrange
Graph Nodes...</span> from the <span class="menu">Data</span> menu, choose the referenced, the referencing,
and optionally a connection strength column. Then click <span class="menu">OK</span>.
Now <span class="keyword">DataWarrior</span> creates a new 2D-view that shows all rows using freshly
generated coordinates. It also shows a connection line for every defined row relationship.</p>

<p align="center"><img src="help/img/analysis/directedGraph.jpeg" width=489 height=390></p>
<p><center><i>2D-View displaying directed graph after Rubberband Scaling.</i></center></p>

<p>In addition, a second 2D-view is created and configured to display a sub-graph tree with the current
reference row as root, provided that a reference row is chosen. Whenever the reference row changes, because
a different row is clicked with the mouse in any view, then the sub-graph is automatically updated to show
multiple layers of the newly selected reference row's neighbours.</p>

<p align="center"><img src="help/img/analysis/graph.jpeg" width=539 height=427></p>
<p><center><i>2D-View configured to show circular detail graph with 'Lightning Injuries' as root.</i></center></p>

<p>For more information about how to use connection lines and detail tree sub-graphs check the section
on <a href="help/views.html#ConnectionLines">connection lines</a>.</p>
<br>

<p align="center">Continue with <a href="help/ml.html">Machine Learning</a>...</p>
<br>
</body>
</html>
